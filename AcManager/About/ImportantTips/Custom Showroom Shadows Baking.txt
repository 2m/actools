sid: 15bkos8n
id: shadowsBaking

As far as I know, to calculate ambient occlusion maps proper renderers use some sort of ray tracing, and with it they try to figure out if a specific piece of surface is lit or not. Here, I tried to implement a different approach which turned out to be faster and smoother, but, of course, with its own flaws. Still, if you don’t want to bother with all those renderers and just want to, let’s say, fix some mod not having AO map, Content Manager might help you.

[img="http://i.imgur.com/xRAum4q.jpg|240"]Original texture by Kunos[/img] [img="http://i.imgur.com/vQ5rBkw.jpg|240"]AO map generated by Content Manager, with range −10°…90°[/img] [img="http://i.imgur.com/Q0J8wRE.jpg|240"]Did you ever wonder why not simply use SSAO instead? Apart from performance, that’s why[/img] [img="http://i.imgur.com/nQ6tNFY.jpg|240"]For comparison, the same car without AO map, just slightly dimmed to compensate materials being set to work with AO map[/img]

What Content Manager does is it simply puts hundreds and thousands of lights randomly distributed on a “sky”, builds a shadow map for each of them and sums them up. Even with thousand of iterations for exterior, the result is quite smooth, and it doesn’t take a lot of time. Also, with this approach, you can easily tune the result for your purposes.

(Think of it as if you had to shoot a car with soft shadows withing a studio with, but only had a thousands of spotlight without any diffusers or reflectors. With thousands of them, you could just put them all around your car and get shadows to be pretty smooth.)

Now, that is what [b]From[/b] and [b]To[/b] options are for. They allow you to specify a range of angles in which spotlights will be located. With 0°…90° range, you’ll get a full hemisphere. With 89°…90°, all lights will come from the top (not sure why would you do that). And with −90°…90° light will come from all around the object — perfect option to render an AO map for something which is being rotated all the time, like a rim.

[b]Brightness[/b] and [b]Gamma[/b] are to tune output brightness curve. You could do the same job in any photo editor, but since result will be saved in non-HDR format, it might be better to do it before saving to minimize information loss. Also, [b]Ambient[/b] option might be needed to add a fake ground-reflected light, just in case bottoms will be getting too dark.

Then, there are two Bias settings. Because of discrete nature of shadow maps, CM has to apply shadow within some distance from a surface which casted it (to avoid self-shadowing), and draws shadow in two passes. Imagine looking from a light source. At first pass, only shadows from facing away surfaces will be draws, with an offset adjusted by [b]Bias (first)[/b] (usually, there is no problem with self-shadowing with that). Then, only shadows from surfaces facing the light source, and offset will be adjusted by [b]Bias (second)[/b] (this one should be positive and quite big).

[b]Iterations[/b] is just an amount of lights casting shadows and [b]Padding[/b] allows to add some extra pixels around objects to avoid issues with UV seams, especially visible from the distance. [b]Pixel Density[/b] is a multiplier for resolution with subsequent downscaling for extra smoothness, [b]Shadow maps’ resolution[/b] is a resolution of those shadow maps built for each of spotlights and [b]FXAA[/b] enables a Fast Approximate Anti-Aliasing pass to make result smoother.
