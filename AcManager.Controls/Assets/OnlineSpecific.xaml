<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:acManagersNew="clr-namespace:AcManager.Tools.AcManagersNew;assembly=AcManager.Tools"
        xmlns:acObjectsNew="clr-namespace:AcManager.Tools.AcObjectsNew;assembly=AcManager.Tools" xmlns:system="clr-namespace:System;assembly=mscorlib"
        xmlns:converters="clr-namespace:AcManager.Controls.Converters" xmlns:acObjects="clr-namespace:AcManager.Tools.Objects;assembly=AcManager.Tools"
        xmlns:userControls="clr-namespace:AcManager.Controls.UserControls" xmlns:mui="http://firstfloorsoftware.com/ModernUI"
        xmlns:online="clr-namespace:AcManager.Tools.Managers.Online;assembly=AcManager.Tools" xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="d">
    <ResourceDictionary.MergedDictionaries>
        <mui:SharedResourceDictionary Source="/AcManager.Controls;component/Assets/IconData.xaml" />
        <mui:SharedResourceDictionary Source="/AcManager.Controls;component/Assets/Converters.xaml" />
    </ResourceDictionary.MergedDictionaries>

    <!--car & track previews-->
    <ToolTip x:Key="CarPreviewTooltip">
        <Grid>
            <StackPanel Margin="4 8" Visibility="{Binding CarExists, Converter={StaticResource BooleanToVisibilityConverter}}">
                <TextBlock Style="{StaticResource Heading2}" Text="{Binding CarObjectWrapper.Value.DisplayName}" Margin="0 0 0 4" />
                <userControls:CarBlock Car="{Binding CarObjectWrapper.Value}" ShowSkinsAndPreview="False" SelectSkin="False" Width="512" MaxHeight="320" />
            </StackPanel>
            <DockPanel Margin="4" Visibility="{Binding CarExists, Converter={StaticResource BooleanToVisibilityConverter}, ConverterParameter=inverse}">
                <Path Data="{StaticResource AlertIconData}" Width="16" Height="16" Fill="{DynamicResource Error}" Stretch="Uniform" x:Name="ErrorIcon"
                        DockPanel.Dock="Left" Margin="0 0 4 0" />
                <TextBlock>
                            <Run>Car is missing:</Run>
                            <Run Text="{Binding CarId, Mode=OneWay}" FontWeight="Bold" />
                </TextBlock>
            </DockPanel>
        </Grid>
    </ToolTip>

    <ToolTip x:Key="TrackPreviewTooltip">
        <Grid>
            <StackPanel Margin="4 8" Visibility="{Binding Track, Converter={StaticResource NullToVisibilityConverter}, ConverterParameter=inverse}">
                <TextBlock Style="{StaticResource Heading2}" Text="{Binding Track.DisplayName}" Margin="0 0 0 4" />
                <userControls:TrackBlock Track="{Binding Track}" Width="512" MaxHeight="320" />
            </StackPanel>
            <DockPanel Margin="4" Visibility="{Binding Track, Converter={StaticResource NullToVisibilityConverter}}">
                <Path Data="{StaticResource AlertIconData}" Width="16" Height="16" Fill="{DynamicResource Error}" Stretch="Uniform" x:Name="ErrorIcon"
                        DockPanel.Dock="Left" Margin="0 0 4 0" />
                <TextBlock>
                            <Run>Track is missing:</Run>
                            <Run Text="{Binding TrackId, Mode=OneWay}" FontWeight="Bold" />
                </TextBlock>
            </DockPanel>
        </Grid>
    </ToolTip>

    <!--online-->
    <!--driver & car name-->
    <DataTemplate x:Key="OnlineDriverEntry">
        <DockPanel Width="200">
            <mui:BetterImage Filename="{Binding CarSkin.LiveryImage}" Width="16" Height="16" Margin="4" ClearOnChange="True" />
            <TextBlock Text="{Binding Name}" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis" DockPanel.Dock="Top" />
            <TextBlock Text="{Binding Car.DisplayName}" Style="{StaticResource Small}" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis" />
        </DockPanel>
    </DataTemplate>

    <!--tooltips for clients-->
    <ToolTip x:Key="ClientsTooltip">
        <StackPanel Visibility="{Binding CurrentDrivers.Count, Converter={StaticResource EnumToVisibilityConverter}, ConverterParameter='≠0'}" Margin="4">
            <TextBlock Text="Drivers online:" Style="{StaticResource Label}" />
            <ItemsControl ItemsSource="{Binding CurrentDrivers}" ScrollViewer.HorizontalScrollBarVisibility="Disabled" MaxHeight="480" MaxWidth="450"
                    ItemTemplate="{StaticResource OnlineDriverEntry}" ItemsPanel="{StaticResource WrapItemsPanel}" />
        </StackPanel>
    </ToolTip>

    <!--session block-->
    <DataTemplate x:Key="SessionItem">
        <TextBlock Text="{Binding DisplayTypeShort}" Name="TextBlock" Foreground="{DynamicResource ButtonText}" Style="{StaticResource Label}"
                Background="{DynamicResource ButtonBackground}" Height="20" Width="20" TextAlignment="Center" Padding="0 2 0 0">
            <TextBlock.ToolTip>
                <ToolTip>
                    <StackPanel>
                        <TextBlock Text="{Binding DisplayType}" HorizontalAlignment="Left" Style="{StaticResource Heading2}" />
                        <TextBlock Text="{Binding DisplayDuration}" HorizontalAlignment="Left" Margin="0 4 0 0" />
                    </StackPanel>
                </ToolTip>
            </TextBlock.ToolTip>
                </TextBlock>

        <DataTemplate.Triggers>
            <DataTrigger Binding="{Binding IsActive}" Value="True">
                <Setter TargetName="TextBlock" Property="Background" Value="{DynamicResource ButtonBackgroundPressed}" />
                <Setter TargetName="TextBlock" Property="Foreground" Value="{DynamicResource ButtonTextPressed}" />
            </DataTrigger>
        </DataTemplate.Triggers>
    </DataTemplate>

    <!--car block-->
    <DataTemplate x:Key="CarItem" DataType="{x:Type online:ServerEntry+CarOrOnlyCarIdEntry}">
        <TextBlock Text="{Binding CarObjectWrapper.Value.DisplayName}" Name="TextBlock" HorizontalAlignment="Center"
                ToolTip="{StaticResource CarPreviewTooltip}" Style="{StaticResource Small}" Margin="4 0" Height="20" Padding="2"
                Background="{DynamicResource ButtonBackground}" />

        <DataTemplate.Triggers>
            <DataTrigger Binding="{Binding CarExists}" Value="False">
                <Setter TargetName="TextBlock" Property="Text" Value="{Binding CarId}" />
                <Setter TargetName="TextBlock" Property="Background" Value="{DynamicResource ButtonBackgroundPressed}" />
                <Setter TargetName="TextBlock" Property="Foreground" Value="{DynamicResource ButtonTextPressed}" />
            </DataTrigger>
        </DataTemplate.Triggers>
    </DataTemplate>

    <ContextMenu x:Key="ListItemContextMenu" d:DataContext="{d:DesignInstance {x:Type online:ServerEntry}}">
        <MenuItem Command="{Binding JoinCommand}">
            <MenuItem.Header>
                <TextBlock>
                    <Run>Join Using</Run>
                    <Run Text="{Binding CarsView.CurrentItem.CarObject, Mode=OneWay, FallbackValue='?'}" />
                </TextBlock>
            </MenuItem.Header>
        </MenuItem>
        <MenuItem Header="Add to Recent &amp; Shortcuts" Command="{Binding AddToRecentCommand}" />
    </ContextMenu>

    <!-- lite version -->
    <DataTemplate x:Key="SimpleListItem" DataType="{x:Type acManagersNew:AcItemWrapper}">
        <ContentControl Content="{Binding Value}" Height="20">
            <ContentControl.Resources>
                <!-- placeholder -->
                <DataTemplate DataType="{x:Type acObjectsNew:AcPlaceholderNew}">
                    <TextBlock VerticalAlignment="Center" HorizontalAlignment="Left" Text="{Binding DisplayName}" />
                </DataTemplate>

                <!-- entry -->
                <DataTemplate DataType="{x:Type online:ServerEntry}">
                    <Grid ContextMenu="{StaticResource ListItemContextMenu}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="60" />
                            <ColumnDefinition Width="60" />
                        </Grid.ColumnDefinitions>

                        <Grid.RowDefinitions>
                            <RowDefinition Height="20" />
                        </Grid.RowDefinitions>

                        <DockPanel Grid.Column="0">
                            <Path Data="{StaticResource LockIconData}" Width="12" Height="12" Fill="{DynamicResource WindowText}" Stretch="Uniform"
                                    Visibility="Hidden" x:Name="PasswordIcon" HorizontalAlignment="Left" DockPanel.Dock="Left" ToolTip="Password required"
                                    Margin="10 1 2 3" />
                            <TextBlock Text="{Binding Name}" ToolTip="{Binding Name}" FontSize="{DynamicResource SmallFontSize}" TextWrapping="NoWrap"
                                    TextTrimming="CharacterEllipsis" Margin="2" x:Name="DisplayNameText" />
                        </DockPanel>

                        <TextBlock Text="{Binding DisplayClients}" Grid.Column="1" Style="{StaticResource Small}" HorizontalAlignment="Right"
                                VerticalAlignment="Center" />

                        <StackPanel x:Name="PingPanel" Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                            <TextBlock Text="{Binding Ping, TargetNullValue=?}" Style="{StaticResource Small}" />
                            <TextBlock Text=" ms" Opacity="0.5" Style="{StaticResource Small}" />
                        </StackPanel>

                        <Path Data="{StaticResource AlertIconData}" Width="16" Height="16" Fill="{DynamicResource Error}" Stretch="Uniform"
                                Visibility="Collapsed" x:Name="ErrorIcon" Grid.Column="2" HorizontalAlignment="Right">
                            <Path.ToolTip>
                                <StackPanel>
                                    <TextBlock Style="{StaticResource Heading2}" Text="Error" Margin="4" />
                                    <mui:BbCodeBlock BbCode="{Binding ErrorMessage}" Margin="4" />
                                </StackPanel>
                            </Path.ToolTip>
                        </Path>
                    </Grid>

                    <DataTemplate.Triggers>
                        <DataTrigger Binding="{Binding HasErrors}" Value="True">
                            <Setter Property="FontWeight" Value="Bold" TargetName="DisplayNameText" />
                            <Setter Property="Visibility" Value="Visible" TargetName="ErrorIcon" />
                            <Setter Property="Visibility" Value="Collapsed" TargetName="PingPanel" />
                        </DataTrigger>
                        <DataTrigger Binding="{Binding PasswordRequired}" Value="True">
                            <Setter Property="Visibility" Value="Visible" TargetName="PasswordIcon" />
                        </DataTrigger>
                    </DataTemplate.Triggers>
                </DataTemplate>
            </ContentControl.Resources>
        </ContentControl>
    </DataTemplate>

    <!-- heavy version -->
    <DataTemplate x:Key="DetailedListItem" DataType="{x:Type acManagersNew:AcItemWrapper}">
        <ContentControl Content="{Binding Value}" Height="60">
            <ContentControl.Resources>
                <!-- placeholder -->
                <DataTemplate DataType="{x:Type acObjectsNew:AcPlaceholderNew}">
                    <TextBlock VerticalAlignment="Center" HorizontalAlignment="Left" Text="{Binding DisplayName}" />
                </DataTemplate>

                <!-- entry -->
                <DataTemplate DataType="{x:Type online:ServerEntry}">
                    <Grid ContextMenu="{StaticResource ListItemContextMenu}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="22" />
                            <ColumnDefinition Width="3*" MaxWidth="120" />
                            <ColumnDefinition Width="90" />
                            <ColumnDefinition Width="1*" />
                            <ColumnDefinition Width="32" />
                            <ColumnDefinition Width="40" />
                            <ColumnDefinition Width="40" />
                        </Grid.ColumnDefinitions>

                        <Grid.RowDefinitions>
                            <RowDefinition Height="30" />
                            <RowDefinition Height="30" />
                        </Grid.RowDefinitions>

                        <!-- first row -->
                        <Path Data="{StaticResource LockIconData}" Width="12" Height="12" Fill="{DynamicResource WindowText}" Stretch="Uniform"
                                Visibility="Hidden" x:Name="PasswordIcon" HorizontalAlignment="Left" DockPanel.Dock="Left" ToolTip="Password required"
                                Margin="10 1 2 3" Grid.Column="0" Grid.Row="0" Grid.RowSpan="2" />

                        <TextBlock Text="{Binding Name}" ToolTip="{Binding Name}" Style="{StaticResource Heading2}" TextWrapping="NoWrap"
                                TextTrimming="CharacterEllipsis" Margin="2" x:Name="DisplayNameText" Grid.Column="1" Grid.Row="0" Grid.ColumnSpan="3" />

                        <Image Grid.Row="0" Grid.Column="4" Source="{Binding CountryId, Converter={StaticResource CountryIdToImageConverter}}" Width="24"
                                Height="16" DockPanel.Dock="Left" Margin="0 0 4 0" RenderOptions.BitmapScalingMode="LowQuality" />

                        <TextBlock Text="{Binding DisplayClients}" Grid.Row="0" Grid.Column="5" Style="{StaticResource Small}" HorizontalAlignment="Center"
                                VerticalAlignment="Center" ToolTip="{StaticResource ClientsTooltip}" />

                        <StackPanel x:Name="PingPanel" Grid.Row="0" Grid.Column="6" Orientation="Horizontal" HorizontalAlignment="Right"
                                VerticalAlignment="Center">
                            <TextBlock Text="{Binding Ping, TargetNullValue=?}" Style="{StaticResource Small}" />
                            <TextBlock Text=" ms" Opacity="0.5" Style="{StaticResource Small}" />
                        </StackPanel>

                        <Path Data="{StaticResource AlertIconData}" Width="16" Height="16" Fill="{DynamicResource Error}" Stretch="Uniform"
                                Visibility="Collapsed" x:Name="ErrorIcon" Grid.Row="0" Grid.Column="6" HorizontalAlignment="Right">
                            <Path.ToolTip>
                                <StackPanel>
                                    <TextBlock Style="{StaticResource Heading2}" Text="Error" Margin="4" />
                                    <mui:BbCodeBlock BbCode="{Binding ErrorMessage}" Margin="4" />
                                </StackPanel>
                            </Path.ToolTip>
                        </Path>

                        <!-- second row -->
                        <Rectangle Fill="#11888888" Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="6" />

                        <TextBlock Grid.Column="1" Grid.Row="1" HorizontalAlignment="Left" VerticalAlignment="Stretch" TextWrapping="NoWrap"
                                TextTrimming="CharacterEllipsis" Margin="2 5 2 5" Padding="2" ToolTip="{StaticResource TrackPreviewTooltip}">
                            <TextBlock.Style>
                                <Style TargetType="TextBlock" BasedOn="{StaticResource Small}">
                                    <Setter Property="Text" Value="{Binding Track.DisplayName}" />
                                    <Setter Property="Background" Value="{DynamicResource ButtonBackground}" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding Track}" Value="{x:Null}">
                                            <Setter Property="Text" Value="{Binding TrackId}" />
                                            <Setter Property="Background" Value="{DynamicResource ButtonBackgroundPressed}" />
                                            <Setter Property="Foreground" Value="{DynamicResource ButtonTextPressed}" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>

                        <ItemsControl ItemsSource="{Binding Sessions}" Grid.Column="2" Grid.Row="1" HorizontalAlignment="Left" Margin="4 0 4 0"
                                ItemTemplate="{StaticResource SessionItem}" ItemsPanel="{StaticResource HorizontalItemsPanel}" />

                        <ItemsControl ItemsSource="{Binding CarsOrTheirIds}" Grid.Column="3" Grid.ColumnSpan="4" Grid.Row="1" HorizontalAlignment="Left"
                                ItemsPanel="{StaticResource HorizontalItemsPanel}" ItemTemplate="{StaticResource CarItem}" />
                    </Grid>

                    <DataTemplate.Triggers>
                        <DataTrigger Binding="{Binding HasErrors}" Value="True">
                            <Setter Property="FontWeight" Value="Bold" TargetName="DisplayNameText" />
                            <Setter Property="Visibility" Value="Visible" TargetName="ErrorIcon" />
                            <Setter Property="Visibility" Value="Collapsed" TargetName="PingPanel" />
                        </DataTrigger>
                        <DataTrigger Binding="{Binding PasswordRequired}" Value="True">
                            <Setter Property="Visibility" Value="Visible" TargetName="PasswordIcon" />
                        </DataTrigger>
                    </DataTemplate.Triggers>
                </DataTemplate>
            </ContentControl.Resources>
        </ContentControl>
    </DataTemplate>

    <!-- heavy version+ -->
    <DataTemplate x:Key="DetailedPlusListItem" DataType="{x:Type acManagersNew:AcItemWrapper}">
        <ContentControl Content="{Binding Value}" Height="60">
            <ContentControl.Resources>
                <!-- placeholder -->
                <DataTemplate DataType="{x:Type acObjectsNew:AcPlaceholderNew}">
                    <TextBlock VerticalAlignment="Center" HorizontalAlignment="Left" Text="{Binding DisplayName}" />
                </DataTemplate>

                <!-- entry -->
                <DataTemplate DataType="{x:Type online:ServerEntry}">
                    <Grid ContextMenu="{StaticResource ListItemContextMenu}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="22" />
                            <ColumnDefinition Width="3*" MaxWidth="120" />
                            <ColumnDefinition Width="60" />
                            <ColumnDefinition Width="90" />
                            <ColumnDefinition Width="1*" />
                            <ColumnDefinition Width="120" />
                            <ColumnDefinition Width="40" />
                            <ColumnDefinition Width="40" />
                        </Grid.ColumnDefinitions>

                        <Grid.RowDefinitions>
                            <RowDefinition Height="30" />
                            <RowDefinition Height="30" />
                        </Grid.RowDefinitions>

                        <!-- first row -->
                        <Path Data="{StaticResource LockIconData}" Width="12" Height="12" Fill="{DynamicResource WindowText}" Stretch="Uniform"
                                Visibility="Hidden" x:Name="PasswordIcon" HorizontalAlignment="Left" DockPanel.Dock="Left" ToolTip="Password required"
                                Margin="10 1 2 3" Grid.Column="0" Grid.Row="0" Grid.RowSpan="2" />

                        <TextBlock Text="{Binding Name}" ToolTip="{Binding Name}" Style="{StaticResource Heading2}" TextWrapping="NoWrap"
                                TextTrimming="CharacterEllipsis" Margin="2" x:Name="DisplayNameText" Grid.Column="1" Grid.Row="0" Grid.ColumnSpan="4" />

                        <DockPanel Grid.Row="0" Grid.Column="5" VerticalAlignment="Center" HorizontalAlignment="Left">
                            <Image Source="{Binding CountryId, Converter={StaticResource CountryIdToImageConverter}}" HorizontalAlignment="Right" Width="24"
                                    Height="16" DockPanel.Dock="Left" Margin="0 0 4 0" RenderOptions.BitmapScalingMode="LowQuality" />
                            <TextBlock Text="{Binding Country}" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis" Style="{StaticResource Small}" />
                        </DockPanel>

                        <TextBlock Text="{Binding DisplayClients}" Grid.Row="0" Grid.Column="6" Style="{StaticResource Small}" HorizontalAlignment="Center"
                                VerticalAlignment="Center" ToolTip="{StaticResource ClientsTooltip}" />

                        <StackPanel x:Name="PingPanel" Grid.Row="0" Grid.Column="7" Orientation="Horizontal" HorizontalAlignment="Right"
                                VerticalAlignment="Center">
                            <TextBlock Text="{Binding Ping, TargetNullValue=?}" Style="{StaticResource Small}" />
                            <TextBlock Text=" ms" Opacity="0.5" Style="{StaticResource Small}" />
                        </StackPanel>

                        <Path Data="{StaticResource AlertIconData}" Width="16" Height="16" Fill="{DynamicResource Error}" Stretch="Uniform"
                                Visibility="Collapsed" x:Name="ErrorIcon" Grid.Row="0" Grid.Column="7" HorizontalAlignment="Right">
                            <Path.ToolTip>
                                <StackPanel>
                                    <TextBlock Style="{StaticResource Heading2}" Text="Error" Margin="4" />
                                    <mui:BbCodeBlock BbCode="{Binding ErrorMessage}" Margin="4" />
                                </StackPanel>
                            </Path.ToolTip>
                        </Path>

                        <!-- second row -->
                        <Rectangle Fill="#11888888" Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="6" />

                        <TextBlock Grid.Column="1" Grid.Row="1" HorizontalAlignment="Left" VerticalAlignment="Stretch" TextWrapping="NoWrap"
                                TextTrimming="CharacterEllipsis" Margin="2 5 2 5" Padding="2" ToolTip="{StaticResource TrackPreviewTooltip}">
                            <TextBlock.Style>
                                <Style TargetType="TextBlock" BasedOn="{StaticResource Small}">
                                    <Setter Property="Text" Value="{Binding Track.DisplayName}" />
                                    <Setter Property="Background" Value="{DynamicResource ButtonBackground}" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding Track}" Value="{x:Null}">
                                            <Setter Property="Text" Value="{Binding TrackId}" />
                                            <Setter Property="Background" Value="{DynamicResource ButtonBackgroundPressed}" />
                                            <Setter Property="Foreground" Value="{DynamicResource ButtonTextPressed}" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>

                        <TextBlock Grid.Column="2" Grid.Row="1" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4 -2 0 1"
                                Text="{Binding DisplayTimeLeft}" />
                        <ItemsControl ItemsSource="{Binding Sessions}" Grid.Column="3" Grid.Row="1" HorizontalAlignment="Left" Margin="4 0 4 0"
                                ItemTemplate="{StaticResource SessionItem}" ItemsPanel="{StaticResource HorizontalItemsPanel}" />

                        <ItemsControl ItemsSource="{Binding CarsOrTheirIds}" Grid.Column="4" Grid.ColumnSpan="4" Grid.Row="1" HorizontalAlignment="Left"
                                ItemsPanel="{StaticResource HorizontalItemsPanel}" ItemTemplate="{StaticResource CarItem}" />
                    </Grid>

                    <DataTemplate.Triggers>
                        <DataTrigger Binding="{Binding HasErrors}" Value="True">
                            <Setter Property="FontWeight" Value="Bold" TargetName="DisplayNameText" />
                            <Setter Property="Visibility" Value="Visible" TargetName="ErrorIcon" />
                            <Setter Property="Visibility" Value="Collapsed" TargetName="PingPanel" />
                        </DataTrigger>
                        <DataTrigger Binding="{Binding PasswordRequired}" Value="True">
                            <Setter Property="Visibility" Value="Visible" TargetName="PasswordIcon" />
                        </DataTrigger>
                    </DataTemplate.Triggers>
                </DataTemplate>
            </ContentControl.Resources>
        </ContentControl>
    </DataTemplate>

    <Style x:Key="SimpledListItemContainer" TargetType="ListBoxItem" BasedOn="{StaticResource FlatListBoxItem}"/>

    <Style x:Key="DetailedListItemContainer" TargetType="ListBoxItem" BasedOn="{StaticResource FlatListBoxItem}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ListBoxItem">
                    <Border Background="Transparent" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}"
                            Padding="{TemplateBinding Padding}" SnapsToDevicePixels="true">
                        <Grid>
                            <Rectangle Name="Bd" Fill="{TemplateBinding Background}" HorizontalAlignment="Left" Width="4" />
                            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                    VerticalAlignment="{TemplateBinding VerticalContentAlignment}" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="true">
                            <Setter TargetName="Bd" Property="Fill" Value="{DynamicResource ItemBackgroundHover}" />
                        </Trigger>
                        <Trigger Property="IsSelected" Value="true">
                            <Setter TargetName="Bd" Property="Fill" Value="{DynamicResource ItemBackgroundSelected}" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>

        <Style.Triggers>
            <Trigger Property="IsSelected" Value="True">
                <Setter Property="Foreground" Value="{DynamicResource ItemText}" />
                <Setter Property="FontWeight" Value="Normal" />
            </Trigger>
        </Style.Triggers>
    </Style>

    <!--quick filter buttons-->
    <Style TargetType="{x:Type mui:ModernToggleButton}" BasedOn="{StaticResource {x:Type mui:ModernButton}}">
        <Setter Property="EllipseDiameter" Value="12" />
        <Setter Property="Margin" Value="4 0 0 0" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type mui:ModernToggleButton}">
                    <Grid Background="Transparent" Margin="{TemplateBinding Padding}" Width="{TemplateBinding EllipseDiameter}"
                            Height="{TemplateBinding EllipseDiameter}">
                        <Path x:Name="IconPath" Data="{TemplateBinding IconData}" Fill="{TemplateBinding Foreground}" Stretch="Uniform"
                                SnapsToDevicePixels="True" />
                        <Path Data="F1 M 60,0 L0,60 L4,64 L64,4 Z" Fill="Red" Stretch="Uniform"
                                Visibility="{TemplateBinding IsChecked, Converter={StaticResource BooleanToVisibilityConverter}}" SnapsToDevicePixels="True"
                                Margin="-2" />
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Foreground" Value="{DynamicResource ModernButtonTextHover}" />
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter Property="Foreground" Value="{DynamicResource ModernButtonTextPressed}" />
                            <Setter TargetName="IconPath" Property="Fill" Value="{DynamicResource ModernButtonIconForegroundPressed}" />
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Foreground" Value="{DynamicResource ModernButtonTextDisabled}" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary>